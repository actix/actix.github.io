<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=https://actix.rs/css/bootstrap-reboot.css><link rel=stylesheet href=https://actix.rs/css/bootstrap.css><link rel=stylesheet href=https://actix.rs/css/font-awesome.min.css><link rel=stylesheet href=https://actix.rs/css/actix.css><link rel=stylesheet href=https://actix.rs/css/highlight.css><link rel=icon href=https://actix.rs/favicon.ico title=actix><title>URL Dispatch</title></head><body><header class="navbar navbar-light navbar-toggleable-md bd-navbar"><nav class=actix-main-nav><div class="d-flex justify-content-between hidden-lg-up"><a href=https://actix.rs/ class=navbar-brand><img src=https://actix.rs/img/logo-nav.png class=align-middle alt></a>
<button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#actix-main-nav aria-label="Toggle navigation" aria-controls=actix-main-nav aria-expanded=false>
<span class=navbar-toggler-icon></span></button></div><div class="navbar-collapse collapse" id=actix-main-nav><ul class="nav navbar-nav"><li class="nav-item hd-lg-down"><a class=navbar-brand href=https://actix.rs/><img src=https://actix.rs/img/logo-nav.png class=align-middle alt></a></li><li class=nav-item><a class=nav-link href=https://actix.rs/>Home</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/docs/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/community/>Community</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/code/>Code</a></li></ul></div></nav></header><div class=actix-pageheader><div class=container><h1 class=display-4>URL Dispatch</h1></div></div><div class="container actix-docs"><div class=row><div class=col-md-3><button class="btn doctoggle" type=button data-toggle=collapse data-target=#collapsing-docnav aria-expanded=false aria-controls=collapsing-docnav>
Toggle navigation</button><nav class="leftnav collapse show" id=collapsing-docnav><div><h5>Introduction</h5><div><ul class=nav><li><a href=https://actix.rs/docs/>Welcome</a></li><li><a href=https://actix.rs/docs/whatis/>What is Actix</a></li><li><a href=https://actix.rs/docs/installation/>Installation</a></li></ul></div><h5>Basics</h5><div><ul class=nav><li><a href=https://actix.rs/docs/getting-started/>Getting Started</a></li><li><a href=https://actix.rs/docs/application/>Application</a></li><li><a href=https://actix.rs/docs/server/>Server</a></li><li><a href=https://actix.rs/docs/handlers/>Handlers</a></li><li><a href=https://actix.rs/docs/extractors/>Extractors</a></li></ul></div><h5>Advanced</h5><div><ul class=nav><li><a href=https://actix.rs/docs/errors/>Errors</a></li><li class=active><a href=https://actix.rs/docs/url-dispatch/>URL Dispatch</a></li><li><a href=https://actix.rs/docs/request/>Requests</a></li><li><a href=https://actix.rs/docs/response/>Responses</a></li><li><a href=https://actix.rs/docs/testing/>Testing</a></li><li><a href=https://actix.rs/docs/middleware/>Middlewares</a></li><li><a href=https://actix.rs/docs/static-files/>Static Files</a></li></ul></div><h5>Protocols</h5><div><ul class=nav><li><a href=https://actix.rs/docs/websockets/>Websockets</a></li><li><a href=https://actix.rs/docs/http2/>HTTP/2.0</a></li></ul></div><h5>Patterns</h5><div><ul class=nav><li><a href=https://actix.rs/docs/autoreload/>Autoreloading</a></li><li><a href=https://actix.rs/docs/databases/>Databases</a></li></ul></div><h5>Diagrams</h5><div><ul class=nav><li><a href=https://actix.rs/docs/http_server_init/>Http Server Initialization</a></li><li><a href=https://actix.rs/docs/conn_lifecycle/>Connection Lifecycle</a></li></ul></div><h5>API Documentation</h5><div><ul class=nav><li><a href=https://docs.rs/actix target=view_window>actix <span class="fa fa-external-link"></span></a></li><li><a href=https://docs.rs/actix-web/ target=view_window>actix-web <span class="fa fa-external-link"></span></a></li></ul></div></div></nav></div><div class=col-md-9><div class=actix-content><h1 id=url-dispatch>URL Dispatch</h1><p>URL dispatch provides a simple way for mapping URLs to handler code using a simple pattern
matching language. If one of the patterns matches the path information associated with a request,
a particular handler object is invoked.</p><blockquote><p>A request handler is a function that accepts zero or more parameters that can be extracted
from a request (ie, <a href=https://docs.rs/actix-web/2/actix_web/trait.FromRequest.html><em>impl FromRequest</em></a>) and returns a type that can
be converted into an HttpResponse (ie, <a href=https://docs.rs/actix-web/2/actix_web/trait.Responder.html><em>impl Responder</em></a>). More information
is available in the <a href=../handlers/>handler section</a>.</p></blockquote><h1 id=resource-configuration>Resource configuration</h1><p>Resource configuration is the act of adding a new resources to an application. A resource
has a name, which acts as an identifier to be used for URL generation. The name also
allows developers to add routes to existing resources. A resource also has a pattern,
meant to match against the <em>PATH</em> portion of a <em>URL</em> (the portion following the scheme and
port, e.g. <em>/foo/bar</em> in the <em>URL</em> <em>http://localhost:8080/foo/bar?q=value</em>). It does not
match against the <em>QUERY</em> portion (the portion that follows <em>?</em>, e.g. <em>q=value</em>
in <em>http://localhost:8080/foo/bar?q=value</em>).</p><p>The <a href=https://docs.rs/actix-web/2/actix_web/struct.App.html#method.route><em>App::route()</em></a> method provides simple way of registering routes. This
method adds a single route to application routing table. This method accepts a <em>path pattern</em>,
<em>http method</em> and a handler function. <code>route()</code> method could be called multiple times
for the same path, in that case, multiple routes register for the same resource path.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;Hello&#34;</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/user&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>post</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>While <em>App::route()</em> provides simple way of registering routes, to access complete resource
configuration, a different method has to be used. The <a href="https://docs.rs/actix-web/2/actix_web/struct.App.html?search=#method.service"><em>App::service()</em></a> method
adds a single <a href=https://docs.rs/actix-web/2/actix_web/struct.Resource.html>resource</a> to application routing table. This method accepts a
<em>path pattern</em>, guards, and one or more routes.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>guard</span><span class=p>,</span><span class=w> </span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>fn</span> <span class=nf>index</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;Hello&#34;</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>pub</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/prefix&#34;</span><span class=p>).</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/user/{name}&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>name</span><span class=p>(</span><span class=s>&#34;user_detail&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Header</span><span class=p>(</span><span class=s>&#34;content-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;application/json&#34;</span><span class=p>))</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>()))</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>put</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>())),</span><span class=w>
</span><span class=w>        </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>If a resource does not contain any route or does not have any matching routes, it
returns <em>NOT FOUND</em> http response.</p><h2 id=configuring-a-route>Configuring a Route</h2><p>Resource contains a set of routes. Each route in turn has a set of <code>guards</code> and a handler.
New routes can be created with <code>Resource::route()</code> method which returns a reference
to new <em>Route</em> instance. By default the <em>route</em> does not contain any guards, so matches
all requests and the default handler is <code>HttpNotFound</code>.</p><p>The application routes incoming requests based on route criteria which are defined during
resource registration and route registration. Resource matches all routes it contains in
the order the routes were registered via <code>Resource::route()</code>.</p><blockquote><p>A <em>Route</em> can contain any number of <em>guards</em> but only one handler.</p></blockquote><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>    </span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/path&#34;</span><span class=p>).</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>        </span><span class=n>web</span>::<span class=n>route</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>())</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Header</span><span class=p>(</span><span class=s>&#34;content-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;text/plain&#34;</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>()),</span><span class=w>
</span><span class=w>    </span><span class=p>),</span><span class=w>
</span><span class=w></span><span class=p>)</span><span class=w>
</span></code></pre></div><p>In this example, <code>HttpResponse::Ok()</code> is returned for <em>GET</em> requests if the request
contains <code>Content-Type</code> header, the value of this header is <em>text/plain</em>, and path
equals to <code>/path</code>.</p><p>If a resource can not match any route, a &ldquo;NOT FOUND&rdquo; response is returned.</p><p><a href=https://docs.rs/actix-web/2/actix_web/struct.Resource.html#method.route><em>ResourceHandler::route()</em></a> returns a <a href=https://docs.rs/actix-web/2/actix_web/struct.Route.html><em>Route</em></a> object. Route
can be configured with a builder-like pattern. Following configuration methods are available:</p><ul><li><a href=https://docs.rs/actix-web/2/actix_web/struct.Route.html#method.guard><em>Route::guard()</em></a> registers a new guard. Any number of guards can be
registered for each route.</li><li><a href=https://docs.rs/actix-web/2/actix_web/struct.Route.html#method.method><em>Route::method()</em></a> registers a method guard. Any number of guards can be
registered for each route.</li><li><a href=https://docs.rs/actix-web/2/actix_web/struct.Route.html#method.to><em>Route::to()</em></a> registers handler function for this route. Only one handler
can be registered. Usually handler registration is the last config operation.</li><li><a href=https://docs.rs/actix-web/2/actix_web/struct.Route.html#method.to_async><em>Route::to_async()</em></a> registers an async handler function for this route.
Only one handler can be registered. Handler registration is the last config operation.</li></ul><h1 id=route-matching>Route matching</h1><p>The main purpose of route configuration is to match (or not match) the request&rsquo;s <code>path</code>
against a URL path pattern. <code>path</code> represents the path portion of the URL that was requested.</p><p>The way that <em>actix-web</em> does this is very simple. When a request enters the system,
for each resource configuration declaration present in the system, actix checks
the request&rsquo;s path against the pattern declared. This checking happens in the order that
the routes were declared via <code>App::service()</code> method. If resource can not be found,
the <em>default resource</em> is used as the matched resource.</p><p>When a route configuration is declared, it may contain route guard arguments. All route
guards associated with a route declaration must be <code>true</code> for the route configuration to
be used for a given request during a check. If any guard in the set of route guard
arguments provided to a route configuration returns <code>false</code> during a check, that route is
skipped and route matching continues through the ordered set of routes.</p><p>If any route matches, the route matching process stops and the handler associated with
the route is invoked. If no route matches after all route patterns are exhausted, a
<em>NOT FOUND</em> response get returned.</p><h1 id=resource-pattern-syntax>Resource pattern syntax</h1><p>The syntax of the pattern matching language used by actix in the pattern
argument is straightforward.</p><p>The pattern used in route configuration may start with a slash character. If the pattern
does not start with a slash character, an implicit slash will be prepended
to it at matching time. For example, the following patterns are equivalent:</p><pre><code>{foo}/bar/baz
</code></pre><p>and:</p><pre><code>/{foo}/bar/baz
</code></pre><p>A <em>variable part</em> (replacement marker) is specified in the form <em>{identifier}</em>,
where this means &ldquo;accept any characters up to the next slash character and use this
as the name in the <code>HttpRequest.match_info()</code> object&rdquo;.</p><p>A replacement marker in a pattern matches the regular expression <code>[^{}/]+</code>.</p><p>A match_info is the <code>Params</code> object representing the dynamic parts extracted from a
<em>URL</em> based on the routing pattern. It is available as <em>request.match_info</em>. For example, the
following pattern defines one literal segment (foo) and two replacement markers (baz, and bar):</p><pre><code>foo/{baz}/{bar}
</code></pre><p>The above pattern will match these URLs, generating the following match information:</p><pre><code>foo/1/2        -&gt; Params {'baz':'1', 'bar':'2'}
foo/abc/def    -&gt; Params {'baz':'abc', 'bar':'def'}
</code></pre><p>It will not match the following patterns however:</p><pre><code>foo/1/2/        -&gt; No match (trailing slash)
bar/abc/def     -&gt; First segment literal mismatch
</code></pre><p>The match for a segment replacement marker in a segment will be done only up to
the first non-alphanumeric character in the segment in the pattern. So, for instance,
if this route pattern was used:</p><pre><code>foo/{name}.html
</code></pre><p>The literal path <em>/foo/biz.html</em> will match the above route pattern, and the match result
will be <code>Params{'name': 'biz'}</code>. However, the literal path <em>/foo/biz</em> will not match,
because it does not contain a literal <em>.html</em> at the end of the segment represented
by <em>{name}.html</em> (it only contains biz, not biz.html).</p><p>To capture both segments, two replacement markers can be used:</p><pre><code>foo/{name}.{ext}
</code></pre><p>The literal path <em>/foo/biz.html</em> will match the above route pattern, and the match
result will be <em>Params{&lsquo;name&rsquo;: &lsquo;biz&rsquo;, &lsquo;ext&rsquo;: &lsquo;html&rsquo;}</em>. This occurs because there is a
literal part of <em>.</em> (period) between the two replacement markers <em>{name}</em> and <em>{ext}</em>.</p><p>Replacement markers can optionally specify a regular expression which will be used to decide
whether a path segment should match the marker. To specify that a replacement marker should
match only a specific set of characters as defined by a regular expression, you must use a
slightly extended form of replacement marker syntax. Within braces, the replacement marker
name must be followed by a colon, then directly thereafter, the regular expression. The default
regular expression associated with a replacement marker <em>[^/]+</em> matches one or more characters
which are not a slash. For example, under the hood, the replacement marker <em>{foo}</em> can more
verbosely be spelled as <em>{foo:[^/]+}</em>. You can change this to be an arbitrary regular expression
to match an arbitrary sequence of characters, such as <em>{foo:\d+}</em> to match only digits.</p><p>Segments must contain at least one character in order to match a segment replacement marker.
For example, for the URL <em>/abc/</em>:</p><ul><li><em>/abc/{foo}</em> will not match.</li><li><em>/{foo}/</em> will match.</li></ul><blockquote><p><strong>Note</strong>: path will be URL-unquoted and decoded into valid unicode string before
matching pattern and values representing matched path segments will be URL-unquoted too.</p></blockquote><p>So for instance, the following pattern:</p><pre><code>foo/{bar}
</code></pre><p>When matching the following URL:</p><pre><code>http://example.com/foo/La%20Pe%C3%B1a
</code></pre><p>The matchdict will look like so (the value is URL-decoded):</p><pre><code>Params{'bar': 'La Pe\xf1a'}
</code></pre><p>Literal strings in the path segment should represent the decoded value of the
path provided to actix. You don&rsquo;t want to use a URL-encoded value in the pattern.
For example, rather than this:</p><pre><code>/Foo%20Bar/{baz}
</code></pre><p>You&rsquo;ll want to use something like this:</p><pre><code>/Foo Bar/{baz}
</code></pre><p>It is possible to get &ldquo;tail match&rdquo;. For this purpose custom regex has to be used.</p><pre><code>foo/{bar}/{tail:.*}
</code></pre><p>The above pattern will match these URLs, generating the following match information:</p><pre><code>foo/1/2/           -&gt; Params{'bar':'1', 'tail': '2/'}
foo/abc/def/a/b/c  -&gt; Params{'bar':u'abc', 'tail': 'def/a/b/c'}
</code></pre><h1 id=scoping-routes>Scoping Routes</h1><p>Scoping helps you organize routes sharing common root paths. You can nest
scopes within scopes.</p><p>Suppose that you want to organize paths to endpoints used to view &ldquo;Users&rdquo;. Such paths may include:</p><ul><li>/users</li><li>/users/show</li><li>/users/show/{id}</li></ul><p>A scoped layout of these paths would appear as follows</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>show_users</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;Show users&#34;</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>user_detail</span><span class=p>(</span><span class=n>path</span>: <span class=nc>web</span>::<span class=n>Path</span><span class=o>&lt;</span><span class=p>(</span><span class=kt>u32</span><span class=p>,)</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;User detail: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>path</span><span class=p>.</span><span class=mi>0</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/users&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/show&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>show_users</span><span class=p>))</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/show/{id}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>user_detail</span><span class=p>)),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>A <em>scoped</em> path can contain variable path segments as resources. Consistent with
unscoped paths.</p><p>You can get variable path segments from <code>HttpRequest::match_info()</code>.
<a href=../extractors><code>Path</code> extractor</a> also is able to extract scope level variable segments.</p><h1 id=match-information>Match information</h1><p>All values representing matched path segments are available in <a href=https://docs.rs/actix-web/2/actix_web/struct.HttpRequest.html#method.match_info><code>HttpRequest::match_info</code></a>.
Specific values can be retrieved with <a href=https://docs.rs/actix-web/2/actix_web/dev/struct.Path.html#method.get><code>Path::get()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>HttpRequest</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>,</span><span class=w> </span><span class=nb>Result</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>req</span>: <span class=nc>HttpRequest</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>v1</span>: <span class=kt>u8</span> <span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>match_info</span><span class=p>().</span><span class=n>get</span><span class=p>(</span><span class=s>&#34;v1&#34;</span><span class=p>).</span><span class=n>unwrap</span><span class=p>().</span><span class=n>parse</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>v2</span>: <span class=kt>u8</span> <span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>match_info</span><span class=p>().</span><span class=n>query</span><span class=p>(</span><span class=s>&#34;v2&#34;</span><span class=p>).</span><span class=n>parse</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>v3</span><span class=p>,</span><span class=w> </span><span class=n>v4</span><span class=p>)</span>: <span class=p>(</span><span class=kt>u8</span><span class=p>,</span><span class=w> </span><span class=kt>u8</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>match_info</span><span class=p>().</span><span class=n>load</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Values {} {} {} {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>v1</span><span class=p>,</span><span class=w> </span><span class=n>v2</span><span class=p>,</span><span class=w> </span><span class=n>v3</span><span class=p>,</span><span class=w> </span><span class=n>v4</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/a/{v1}/{v2}/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>()))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>For this example for path &lsquo;/a/1/2/&rsquo;, values v1 and v2 will resolve to &ldquo;1&rdquo; and &ldquo;2&rdquo;.</p><p>It is possible to create a <code>PathBuf</code> from a tail path parameter. The returned <code>PathBuf</code> is
percent-decoded. If a segment is equal to &ldquo;..&rdquo;, the previous segment (if
any) is skipped.</p><p>For security purposes, if a segment meets any of the following conditions,
an <code>Err</code> is returned indicating the condition met:</p><ul><li>Decoded segment starts with any of: <code>.</code> (except <code>..</code>), <code>*</code></li><li>Decoded segment ends with any of: <code>:</code>, <code>></code>, <code>&lt;</code></li><li>Decoded segment contains any of: <code>/</code></li><li>On Windows, decoded segment contains any of: &lsquo;'</li><li>Percent-encoding results in invalid UTF8.</li></ul><p>As a result of these conditions, a <code>PathBuf</code> parsed from request path parameter is
safe to interpolate within, or use as a suffix of, a path without additional checks.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>HttpRequest</span><span class=p>,</span><span class=w> </span><span class=nb>Result</span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>path</span>::<span class=n>PathBuf</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>req</span>: <span class=nc>HttpRequest</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>path</span>: <span class=nc>PathBuf</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>match_info</span><span class=p>().</span><span class=n>query</span><span class=p>(</span><span class=s>&#34;tail&#34;</span><span class=p>).</span><span class=n>parse</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Path {:?}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>path</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>route</span><span class=p>(</span><span class=s>r&#34;/a/{tail:.*}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>)))</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h2 id=path-information-extractor>Path information extractor</h2><p>Actix provides functionality for type safe path information extraction. <a href=https://docs.rs/actix-web/2/actix_web/dev/struct.Path.html><em>Path</em></a>
extracts information, destination type could be defined in several different forms. Simplest
approach is to use <code>tuple</code> type. Each element in tuple must correpond to one element from
path pattern. i.e. you can match path pattern <code>/{id}/{username}/</code> against
<code>Path&lt;(u32, String)></code> type, but <code>Path&lt;(String, String, String)></code> type will always fail.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=nb>Result</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>info</span>: <span class=nc>web</span>::<span class=n>Path</span><span class=o>&lt;</span><span class=p>(</span><span class=nb>String</span><span class=p>,</span><span class=w> </span><span class=kt>u32</span><span class=p>)</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Welcome {}! id: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>info</span><span class=p>.</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>info</span><span class=p>.</span><span class=mi>1</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;/{username}/{id}/index.html&#34;</span><span class=p>,</span><span class=w> </span><span class=c1>// &lt;- define path parameters
</span><span class=c1></span><span class=w>            </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>It also possible to extract path pattern information to a struct. In this case,
this struct must implement *serde&rsquo;s *<code>Deserialize</code> trait.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=nb>Result</span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>serde</span>::<span class=n>Deserialize</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[derive(Deserialize)]</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>Info</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>username</span>: <span class=nb>String</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// extract path info using serde
</span><span class=c1></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>info</span>: <span class=nc>web</span>::<span class=n>Path</span><span class=o>&lt;</span><span class=n>Info</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Welcome {}!&#34;</span><span class=p>,</span><span class=w> </span><span class=n>info</span><span class=p>.</span><span class=n>username</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;/{username}/index.html&#34;</span><span class=p>,</span><span class=w> </span><span class=c1>// &lt;- define path parameters
</span><span class=c1></span><span class=w>            </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p><a href=https://docs.rs/actix-web/2/actix_web/web/struct.Query.html><em>Query</em></a> provides similar functionality for request query parameters.</p><h1 id=generating-resource-urls>Generating resource URLs</h1><p>Use the <a href=https://docs.rs/actix-web/2/actix_web/struct.HttpRequest.html#method.url_for><em>HttpRequest.url_for()</em></a> method to generate URLs based on resource
patterns. For example, if you&rsquo;ve configured a resource with the name &ldquo;foo&rdquo; and the
pattern &ldquo;{a}/{b}/{c}&rdquo;, you might do this:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>guard</span><span class=p>,</span><span class=w> </span><span class=n>http</span>::<span class=n>header</span><span class=p>,</span><span class=w> </span><span class=n>HttpRequest</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>,</span><span class=w> </span><span class=nb>Result</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>req</span>: <span class=nc>HttpRequest</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=n>HttpResponse</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>url_for</span><span class=p>(</span><span class=s>&#34;foo&#34;</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=p>[</span><span class=s>&#34;1&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;2&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;3&#34;</span><span class=p>])</span><span class=o>?</span><span class=p>;</span><span class=w> </span><span class=c1>// &lt;- generate url for &#34;foo&#34; resource
</span><span class=c1></span><span class=w>
</span><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>HttpResponse</span>::<span class=n>Found</span><span class=p>()</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>header</span><span class=p>(</span><span class=n>header</span>::<span class=n>LOCATION</span><span class=p>,</span><span class=w> </span><span class=n>url</span><span class=p>.</span><span class=n>as_str</span><span class=p>())</span><span class=w>
</span><span class=w>        </span><span class=p>.</span><span class=n>finish</span><span class=p>())</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>                </span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/test/{a}/{b}/{c}&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>name</span><span class=p>(</span><span class=s>&#34;foo&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// &lt;- set resource name, then it could be used in `url_for`
</span><span class=c1></span><span class=w>                    </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>())</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>()),</span><span class=w>
</span><span class=w>            </span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/test/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>This would return something like the string <em><a href=http://example.com/test/1/2/3>http://example.com/test/1/2/3</a></em> (at least if
the current protocol and hostname implied <a href=http://example.com>http://example.com</a>). <code>url_for()</code> method
returns <a href=https://docs.rs/url/1.7.2/url/struct.Url.html><em>Url object</em></a> so you can modify this url (add query parameters, anchor, etc).
<code>url_for()</code> could be called only for <em>named</em> resources otherwise error get returned.</p><h1 id=external-resources>External resources</h1><p>Resources that are valid URLs, can be registered as external resources. They are useful
for URL generation purposes only and are never considered for matching at request time.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>HttpRequest</span><span class=p>,</span><span class=w> </span><span class=n>Responder</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>req</span>: <span class=nc>HttpRequest</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>impl</span><span class=w> </span><span class=n>Responder</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>url_for</span><span class=p>(</span><span class=s>&#34;youtube&#34;</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=p>[</span><span class=s>&#34;oHg5SJYRHA0&#34;</span><span class=p>]).</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span><span class=w>    </span><span class=n>assert_eq</span><span class=o>!</span><span class=p>(</span><span class=n>url</span><span class=p>.</span><span class=n>as_str</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;https://youtube.com/watch/oHg5SJYRHA0&#34;</span><span class=p>);</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>url</span><span class=p>.</span><span class=n>into_string</span><span class=p>()</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>external_resource</span><span class=p>(</span><span class=s>&#34;youtube&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;https://youtube.com/watch/{video_id}&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>actix_web</span>::<span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=path-normalization-and-redirecting-to-slash-appended-routes>Path normalization and redirecting to slash-appended routes</h1><p>By normalizing it means:</p><ul><li>To add a trailing slash to the path.</li><li>To replace multiple slashes with one.</li></ul><p>The handler returns as soon as it finds a path that resolves correctly. The order of
normalization conditions, if all are enabled, is 1) merge, 2) both merge and append and
3) append. If the path resolves with at least one of those conditions, it will redirect
to the new path.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>middleware</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;Hello&#34;</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>wrap</span><span class=p>(</span><span class=n>middleware</span>::<span class=n>NormalizePath</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/resource/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In this example <code>//resource///</code> will be redirected to <code>/resource/</code>.</p><p>In this example, the path normalization handler is registered for all methods,
but you should not rely on this mechanism to redirect <em>POST</em> requests. The redirect of the
slash-appending <em>Not Found</em> will turn a <em>POST</em> request into a GET, losing any
<em>POST</em> data in the original request.</p><p>It is possible to register path normalization only for <em>GET</em> requests only:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>http</span>::<span class=n>Method</span><span class=p>,</span><span class=w> </span><span class=n>middleware</span><span class=p>,</span><span class=w> </span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>wrap</span><span class=p>(</span><span class=n>middleware</span>::<span class=n>NormalizePath</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/resource/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>default_service</span><span class=p>(</span><span class=n>web</span>::<span class=n>route</span><span class=p>().</span><span class=n>method</span><span class=p>(</span><span class=n>Method</span>::<span class=n>GET</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h2 id=using-an-application-prefix-to-compose-applications>Using an Application Prefix to Compose Applications</h2><p>The <code>web::scope()</code> method allows to set a specific application scope. This scope represents
a resource prefix that will be prepended to all resource patterns added by the resource
configuration. This can be used to help mount a set of routes at a different location
than the included callable&rsquo;s author intended while still maintaining the same resource names.</p><p>For example:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>show_users</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;Show users&#34;</span><span class=p>)</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>user_detail</span><span class=p>(</span><span class=n>path</span>: <span class=nc>web</span>::<span class=n>Path</span><span class=o>&lt;</span><span class=p>(</span><span class=kt>u32</span><span class=p>,)</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nc>HttpResponse</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;User detail: {}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>path</span><span class=p>.</span><span class=mi>0</span><span class=p>))</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/users&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/show&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>show_users</span><span class=p>))</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/show/{id}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>user_detail</span><span class=p>)),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In the above example, the <em>show_users</em> route will have an effective route pattern of
<em>/users/show</em> instead of <em>/show</em> because the application&rsquo;s scope will be prepended
to the pattern. The route will then only match if the URL path is <em>/users/show</em>,
and when the <code>HttpRequest.url_for()</code> function is called with the route name show_users,
it will generate a URL with that same path.</p><h1 id=custom-route-guard>Custom route guard</h1><p>You can think of a guard as a simple function that accepts a <em>request</em> object reference
and returns <em>true</em> or <em>false</em>. Formally, a guard is any object that implements the
<a href=https://docs.rs/actix-web/2/actix_web/guard/trait.Guard.html><code>Guard</code></a> trait. Actix provides several predicates, you can check
<a href=https://docs.rs/actix-web/2/actix_web/guard/index.html#functions>functions section</a> of api docs.</p><p>Here is a simple guard that check that a request contains a specific <em>header</em>:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>dev</span>::<span class=n>RequestHead</span><span class=p>,</span><span class=w> </span><span class=n>guard</span>::<span class=n>Guard</span><span class=p>,</span><span class=w> </span><span class=n>http</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>ContentTypeHeader</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>impl</span><span class=w> </span><span class=n>Guard</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>ContentTypeHeader</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>fn</span> <span class=nf>check</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>,</span><span class=w> </span><span class=n>req</span>: <span class=kp>&amp;</span><span class=nc>RequestHead</span><span class=p>)</span><span class=w> </span>-&gt; <span class=kt>bool</span> <span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>req</span><span class=p>.</span><span class=n>headers</span><span class=p>().</span><span class=n>contains_key</span><span class=p>(</span><span class=n>http</span>::<span class=n>header</span>::<span class=n>CONTENT_TYPE</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>}</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>web</span>::<span class=n>route</span><span class=p>()</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>ContentTypeHeader</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>()),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In this example, <em>index</em> handler will be called only if request contains <em>CONTENT-TYPE</em> header.</p><p>Guards can not access or modify the request object, but it is possible to store extra
information in <a href=https://docs.rs/actix-web/2/actix_web/struct.HttpRequest.html#method.extensions>request extensions</a>.</p><h2 id=modifying-guard-values>Modifying guard values</h2><p>You can invert the meaning of any predicate value by wrapping it in a <code>Not</code> predicate.
For example, if you want to return &ldquo;METHOD NOT ALLOWED&rdquo; response for all methods
except &ldquo;GET&rdquo;:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>guard</span><span class=p>,</span><span class=w> </span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>            </span><span class=n>web</span>::<span class=n>route</span><span class=p>()</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Not</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>()))</span><span class=w>
</span><span class=w>                </span><span class=p>.</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=n>MethodNotAllowed</span><span class=p>()),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>The <code>Any</code> guard accepts a list of guards and matches if any of the supplied
guards match. i.e:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>guard</span>::<span class=n>Any</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>()).</span><span class=n>or</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Post</span><span class=p>())</span><span class=w>
</span></code></pre></div><p>The <code>All</code> guard accepts a list of guard and matches if all of the supplied
guards match. i.e:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=n>guard</span>::<span class=n>All</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>()).</span><span class=n>and</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Header</span><span class=p>(</span><span class=s>&#34;content-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;plain/text&#34;</span><span class=p>))</span><span class=w>
</span></code></pre></div><h1 id=changing-the-default-not-found-response>Changing the default Not Found response</h1><p>If the path pattern can not be found in the routing table or a resource can not find matching
route, the default resource is used. The default response is <em>NOT FOUND</em>.
It is possible to override the <em>NOT FOUND</em> response with <code>App::default_service()</code>.
This method accepts a <em>configuration function</em> same as normal resource configuration
with <code>App::service()</code> method.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[actix_rt::main]</span><span class=w>
</span><span class=w></span><span class=n>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>).</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>)))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>default_service</span><span class=p>(</span><span class=w>
</span><span class=w>                </span><span class=n>web</span>::<span class=n>route</span><span class=p>()</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Not</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Get</span><span class=p>()))</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=n>MethodNotAllowed</span><span class=p>()),</span><span class=w>
</span><span class=w>            </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>(</span><span class=s>&#34;127.0.0.1:8088&#34;</span><span class=p>)</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><div class=github-edit><a class="fa fa-github" href=https://github.com/actix/actix-website/tree/master/content/docs/url-dispatch.md>Edit on GitHub</a></div><div class=actix-next><b>Next up</b>: <a href=/docs/request/>Requests</a></div></div></div></div></div><footer class=actix-footer><div class="text-muted actix-footer-gray d-flex justify-content-between"><div class=actix-footer-info>Copyright © 2020 The Actix Team</div><div class=actix-footer-social><a href=https://github.com/actix class=text-muted><i class="fa fa-github" aria-hidden=true></i></a></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script><script src=https://actix.rs/js/bootstrap.min.js></script><script src=https://actix.rs/js/actix.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-110322332-1','auto');ga('send','pageview');}</script></body></html>