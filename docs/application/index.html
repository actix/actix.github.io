<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=https://actix.rs/css/bootstrap-reboot.css><link rel=stylesheet href=https://actix.rs/css/bootstrap.css><link rel=stylesheet href=https://actix.rs/css/font-awesome.min.css><link rel=stylesheet href=https://actix.rs/css/actix.css><link rel=stylesheet href=https://actix.rs/css/highlight.css><link rel=icon href=https://actix.rs/favicon.ico title=actix><title>Application</title></head><body><header class="navbar navbar-light navbar-toggleable-md bd-navbar"><nav class=actix-main-nav><div class="d-flex justify-content-between hidden-lg-up"><a href=https://actix.rs/ class=navbar-brand><img src=https://actix.rs/img/logo-nav.png class=align-middle alt></a>
<button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#actix-main-nav aria-label="Toggle navigation" aria-controls=actix-main-nav aria-expanded=false>
<span class=navbar-toggler-icon></span></button></div><div class="navbar-collapse collapse" id=actix-main-nav><ul class="nav navbar-nav"><li class="nav-item hd-lg-down"><a class=navbar-brand href=https://actix.rs/><img src=https://actix.rs/img/logo-nav.png class=align-middle alt></a></li><li class=nav-item><a class=nav-link href=https://actix.rs/>Home</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/docs/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/community/>Community</a></li><li class=nav-item><a class=nav-link href=https://actix.rs/code/>Code</a></li></ul></div></nav></header><div class=actix-pageheader><div class=container><h1 class=display-4>Application</h1></div></div><div class="container actix-docs"><div class=row><div class=col-md-3><button class="btn doctoggle" type=button data-toggle=collapse data-target=#collapsing-docnav aria-expanded=false aria-controls=collapsing-docnav>
Toggle navigation</button><nav class="leftnav collapse show" id=collapsing-docnav><div><h5>Introduction</h5><div><ul class=nav><li><a href=https://actix.rs/docs/>Welcome</a></li><li><a href=https://actix.rs/docs/whatis/>What is Actix Web</a></li></ul></div><h5>Basics</h5><div><ul class=nav><li><a href=https://actix.rs/docs/getting-started/>Getting Started</a></li><li class=active><a href=https://actix.rs/docs/application/>Application</a></li><li><a href=https://actix.rs/docs/server/>Server</a></li><li><a href=https://actix.rs/docs/handlers/>Handlers</a></li><li><a href=https://actix.rs/docs/extractors/>Extractors</a></li></ul></div><h5>Advanced</h5><div><ul class=nav><li><a href=https://actix.rs/docs/errors/>Errors</a></li><li><a href=https://actix.rs/docs/url-dispatch/>URL Dispatch</a></li><li><a href=https://actix.rs/docs/request/>Requests</a></li><li><a href=https://actix.rs/docs/response/>Responses</a></li><li><a href=https://actix.rs/docs/testing/>Testing</a></li><li><a href=https://actix.rs/docs/middleware/>Middleware</a></li><li><a href=https://actix.rs/docs/static-files/>Static Files</a></li></ul></div><h5>Protocols</h5><div><ul class=nav><li><a href=https://actix.rs/docs/websockets/>Websockets</a></li><li><a href=https://actix.rs/docs/http2/>HTTP/2</a></li></ul></div><h5>Patterns</h5><div><ul class=nav><li><a href=https://actix.rs/docs/autoreload/>Auto-Reloading</a></li><li><a href=https://actix.rs/docs/databases/>Databases</a></li></ul></div><h5>Diagrams</h5><div><ul class=nav><li><a href=https://actix.rs/docs/http_server_init/>HTTP Server Initialization</a></li><li><a href=https://actix.rs/docs/conn_lifecycle/>Connection Lifecycle</a></li></ul></div><h5>API Documentation</h5><div><ul class=nav><li><a href=https://docs.rs/actix target=view_window>actix <span class="fa fa-external-link"></span></a></li><li><a href=https://docs.rs/actix-web/ target=view_window>actix-web <span class="fa fa-external-link"></span></a></li></ul></div></div></nav></div><div class=col-md-9><div class=actix-content><h1 id=writing-an-application>Writing an Application</h1><p><code>actix-web</code> provides various primitives to build web servers and applications with Rust. It provides routing, middleware, pre-processing of requests, post-processing of responses, etc.</p><p>All <code>actix-web</code> servers are built around the <a href=https://docs.rs/actix-web/4/actix_web/struct.App.html><code>App</code></a> instance. It is used for registering routes for resources and middleware. It also stores application state shared across all handlers within the same scope.</p><p>An application&rsquo;s <a href=https://docs.rs/actix-web/4/actix_web/struct.Scope.html><code>scope</code></a> acts as a namespace for all routes, i.e. all routes for a specific application scope have the same url path prefix. The application prefix always contains a leading &ldquo;/&rdquo; slash. If a supplied prefix does not contain leading slash, it is automatically inserted. The prefix should consist of value path segments.</p><blockquote><p>For an application with scope <code>/app</code>, any request with the paths <code>/app</code>, <code>/app/</code>, or <code>/app/test</code> would match; however, the path <code>/application</code> would not match.</p></blockquote><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>,</span><span class=w> </span><span class=n>Responder</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>impl</span><span class=w> </span><span class=n>Responder</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=s>&#34;Hello world!&#34;</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>            </span><span class=c1>// prefixes all resources and routes attached to it...
</span><span class=c1></span><span class=w>            </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/app&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                </span><span class=c1>// ...so this handles requests for `GET /app/index.html`
</span><span class=c1></span><span class=w>                </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/index.html&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>)),</span><span class=w>
</span><span class=w>        </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>((</span><span class=s>&#34;127.0.0.1&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>8080</span><span class=p>))</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=k>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In this example, an application with the <code>/app</code> prefix and an <code>index.html</code> resource is created. This resource is available through the <code>/app/index.html</code> url.</p><blockquote><p>For more information, check the <a href=https://actix.rs/docs/url-dispatch/index.html#using-an-application-prefix-to-compose-applications>URL Dispatch</a> section.</p></blockquote><h2 id=state>State</h2><p>Application state is shared with all routes and resources within the same scope. State can be accessed with the <a href=https://docs.rs/actix-web/4/actix_web/web/struct.Data.html><code>web::Data&lt;T></code></a> extractor where <code>T</code> is the type of the state. State is also accessible for middleware.</p><p>Let&rsquo;s write a simple application and store the application name in the state:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>get</span><span class=p>,</span><span class=w> </span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// This struct represents state
</span><span class=c1></span><span class=k>struct</span> <span class=nc>AppState</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>app_name</span>: <span class=nb>String</span><span class=p>,</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[get(</span><span class=s>&#34;/&#34;</span><span class=cp>)]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>data</span>: <span class=nc>web</span>::<span class=n>Data</span><span class=o>&lt;</span><span class=n>AppState</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>app_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>data</span><span class=p>.</span><span class=n>app_name</span><span class=p>;</span><span class=w> </span><span class=c1>// &lt;- get app_name
</span><span class=c1></span><span class=w>    </span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Hello {app_name}!&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// &lt;- response with app_name
</span><span class=c1></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>Next, pass in the state when initializing the App and start the application:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>app_data</span><span class=p>(</span><span class=n>web</span>::<span class=n>Data</span>::<span class=n>new</span><span class=p>(</span><span class=n>AppState</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>                </span><span class=n>app_name</span>: <span class=nb>String</span>::<span class=n>from</span><span class=p>(</span><span class=s>&#34;Actix-web&#34;</span><span class=p>),</span><span class=w>
</span><span class=w>            </span><span class=p>}))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=n>index</span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>((</span><span class=s>&#34;127.0.0.1&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>8080</span><span class=p>))</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=k>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>Any number of state types could be registered within the application.</p><h2 id=shared-mutable-state>Shared Mutable State</h2><p><code>HttpServer</code> accepts an application factory rather than an application instance. An <code>HttpServer</code> constructs an application instance for each thread. Therefore, application data must be constructed multiple times. If you want to share data between different threads, a shareable object should be used, e.g. <code>Send</code> + <code>Sync</code>.</p><p>Internally, <a href=https://docs.rs/actix-web/4/actix_web/web/struct.Data.html><code>web::Data</code></a> uses <code>Arc</code>. Thus, in order to avoid creating two <code>Arc</code>s, we should create our Data before registering it using <a href=https://docs.rs/actix-web/4/actix_web/struct.App.html#method.app_data><code>App::app_data()</code></a>.</p><p>In the following example, we will write an application with mutable, shared state. First, we define our state and create our handler:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>sync</span>::<span class=n>Mutex</span><span class=p>;</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>struct</span> <span class=nc>AppStateWithCounter</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>counter</span>: <span class=nc>Mutex</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=p>,</span><span class=w> </span><span class=c1>// &lt;- Mutex is necessary to mutate safely across threads
</span><span class=c1></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>index</span><span class=p>(</span><span class=n>data</span>: <span class=nc>web</span>::<span class=n>Data</span><span class=o>&lt;</span><span class=n>AppStateWithCounter</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>String</span> <span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>counter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>data</span><span class=p>.</span><span class=n>counter</span><span class=p>.</span><span class=n>lock</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w> </span><span class=c1>// &lt;- get counter&#39;s MutexGuard
</span><span class=c1></span><span class=w>    </span><span class=o>*</span><span class=n>counter</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=c1>// &lt;- access counter inside MutexGuard
</span><span class=c1></span><span class=w>
</span><span class=w>    </span><span class=n>format</span><span class=o>!</span><span class=p>(</span><span class=s>&#34;Request number: {counter}&#34;</span><span class=p>)</span><span class=w> </span><span class=c1>// &lt;- response with count
</span><span class=c1></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>and register the data in an <code>App</code>:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=c1>// Note: web::Data created _outside_ HttpServer::new closure
</span><span class=c1></span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>counter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>web</span>::<span class=n>Data</span>::<span class=n>new</span><span class=p>(</span><span class=n>AppStateWithCounter</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>counter</span>: <span class=nc>Mutex</span>::<span class=n>new</span><span class=p>(</span><span class=mi>0</span><span class=p>),</span><span class=w>
</span><span class=w>    </span><span class=p>});</span><span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=k>move</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=c1>// move counter into the closure
</span><span class=c1></span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>app_data</span><span class=p>(</span><span class=n>counter</span><span class=p>.</span><span class=n>clone</span><span class=p>())</span><span class=w> </span><span class=c1>// &lt;- register the created data
</span><span class=c1></span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>index</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>((</span><span class=s>&#34;127.0.0.1&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>8080</span><span class=p>))</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=k>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h2 id=using-an-application-scope-to-compose-applications>Using an Application Scope to Compose Applications</h2><p>The <a href=https://docs.rs/actix-web/4/actix_web/web/fn.scope.html><code>web::scope()</code></a> method allows setting a resource group prefix. This scope represents a resource prefix that will be prepended to all resource patterns added by the resource configuration. This can be used to help mount a set of routes at a different location than the original author intended while still maintaining the same resource names.</p><p>For example:</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>scope</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/users&#34;</span><span class=p>).</span><span class=n>service</span><span class=p>(</span><span class=n>show_users</span><span class=p>);</span><span class=w>
</span><span class=w>    </span><span class=n>App</span>::<span class=n>new</span><span class=p>().</span><span class=n>service</span><span class=p>(</span><span class=n>scope</span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>In the above example, the <code>show_users</code> route will have an effective route pattern of <code>/users/show</code> instead of <code>/show</code> because the application&rsquo;s scope argument will be prepended to the pattern. The route will then only match if the URL path is <code>/users/show</code>, and when the <a href=https://docs.rs/actix-web/4/actix_web/struct.HttpRequest.html#method.url_for><code>HttpRequest.url_for()</code></a> function is called with the route name <code>show_users</code>, it will generate a URL with that same path.</p><h2 id=application-guards-and-virtual-hosting>Application guards and virtual hosting</h2><p>You can think of a guard as a simple function that accepts a <em>request</em> object reference and returns <em>true</em> or <em>false</em>. Formally, a guard is any object that implements the <a href=https://docs.rs/actix-web/4/actix_web/guard/trait.Guard.html><code>Guard</code></a> trait. Actix-web provides several guards. You can check the <a href=https://docs.rs/actix-web/4/actix_web/guard/index.html#functions>functions section</a> of the API docs.</p><p>One of the provided guards is <a href=https://docs.rs/actix-web/4/actix_web/guard/fn.Header.html><code>Header</code></a>. It can be used as a filter based on request header information.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>                </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Header</span><span class=p>(</span><span class=s>&#34;Host&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;www.rust-lang.org&#34;</span><span class=p>))</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;www&#34;</span><span class=p>)</span><span class=w> </span><span class=p>})),</span><span class=w>
</span><span class=w>            </span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>                </span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>guard</span><span class=p>(</span><span class=n>guard</span>::<span class=n>Header</span><span class=p>(</span><span class=s>&#34;Host&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;users.rust-lang.org&#34;</span><span class=p>))</span><span class=w>
</span><span class=w>                    </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;user&#34;</span><span class=p>)</span><span class=w> </span><span class=p>})),</span><span class=w>
</span><span class=w>            </span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=n>web</span>::<span class=n>to</span><span class=p>(</span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>))</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>((</span><span class=s>&#34;127.0.0.1&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>8080</span><span class=p>))</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=k>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><h1 id=configure>Configure</h1><p>For simplicity and reusability both <a href=https://docs.rs/actix-web/4/actix_web/struct.App.html#method.configure><code>App</code></a> and <a href=https://docs.rs/actix-web/4/actix_web/struct.Scope.html#method.configure><code>web::Scope</code></a> provide the <code>configure</code> method. This function is useful for moving parts of the configuration to a different module or even library. For example, some of the resource&rsquo;s configuration could be moved to a different module.</p><div class=highlight><pre class=chroma><code class=language-rust data-lang=rust><span class=k>use</span><span class=w> </span><span class=n>actix_web</span>::<span class=p>{</span><span class=n>web</span><span class=p>,</span><span class=w> </span><span class=n>App</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=p>,</span><span class=w> </span><span class=n>HttpServer</span><span class=p>};</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// this function could be located in a different module
</span><span class=c1></span><span class=k>fn</span> <span class=nf>scoped_config</span><span class=p>(</span><span class=n>cfg</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>web</span>::<span class=n>ServiceConfig</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>cfg</span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>        </span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/test&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;test&#34;</span><span class=p>)</span><span class=w> </span><span class=p>}))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>head</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>HttpResponse</span>::<span class=n>MethodNotAllowed</span><span class=p>)),</span><span class=w>
</span><span class=w>    </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=c1>// this function could be located in a different module
</span><span class=c1></span><span class=k>fn</span> <span class=nf>config</span><span class=p>(</span><span class=n>cfg</span>: <span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>web</span>::<span class=n>ServiceConfig</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>cfg</span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=w>
</span><span class=w>        </span><span class=n>web</span>::<span class=n>resource</span><span class=p>(</span><span class=s>&#34;/app&#34;</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;app&#34;</span><span class=p>)</span><span class=w> </span><span class=p>}))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=n>web</span>::<span class=n>head</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=n>HttpResponse</span>::<span class=n>MethodNotAllowed</span><span class=p>)),</span><span class=w>
</span><span class=w>    </span><span class=p>);</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=cp>#[actix_web::main]</span><span class=w>
</span><span class=w></span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span>-&gt; <span class=nc>std</span>::<span class=n>io</span>::<span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>    </span><span class=n>HttpServer</span>::<span class=n>new</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=p>{</span><span class=w>
</span><span class=w>        </span><span class=n>App</span>::<span class=n>new</span><span class=p>()</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>configure</span><span class=p>(</span><span class=n>config</span><span class=p>)</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>service</span><span class=p>(</span><span class=n>web</span>::<span class=n>scope</span><span class=p>(</span><span class=s>&#34;/api&#34;</span><span class=p>).</span><span class=n>configure</span><span class=p>(</span><span class=n>scoped_config</span><span class=p>))</span><span class=w>
</span><span class=w>            </span><span class=p>.</span><span class=n>route</span><span class=p>(</span><span class=w>
</span><span class=w>                </span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w>
</span><span class=w>                </span><span class=n>web</span>::<span class=n>get</span><span class=p>().</span><span class=n>to</span><span class=p>(</span><span class=o>||</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>HttpResponse</span>::<span class=nb>Ok</span><span class=p>().</span><span class=n>body</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>)</span><span class=w> </span><span class=p>}),</span><span class=w>
</span><span class=w>            </span><span class=p>)</span><span class=w>
</span><span class=w>    </span><span class=p>})</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>bind</span><span class=p>((</span><span class=s>&#34;127.0.0.1&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>8080</span><span class=p>))</span><span class=o>?</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=n>run</span><span class=p>()</span><span class=w>
</span><span class=w>    </span><span class=p>.</span><span class=k>await</span><span class=w>
</span><span class=w></span><span class=p>}</span><span class=w>
</span></code></pre></div><p>The result of the above example would be:</p><pre><code>/         -&gt; &quot;/&quot;
/app      -&gt; &quot;app&quot;
/api/test -&gt; &quot;test&quot;
</code></pre><p>Each <a href=https://docs.rs/actix-web/4/actix_web/web/struct.ServiceConfig.html><code>ServiceConfig</code></a> can have its own <code>data</code>, <code>routes</code>, and <code>services</code>.</p><div class=github-edit><a class="fa fa-github" href=https://github.com/actix/actix-website/tree/master/content/docs/application.md>Edit on GitHub</a></div><div class=actix-next><b>Next up</b>: <a href=/docs/server/>Server</a></div></div></div></div></div><footer class=actix-footer><div class="text-muted actix-footer-gray d-flex justify-content-between"><div class=actix-footer-info>Copyright Â© 2022 The Actix Team</div><div class=actix-footer-social><a href=https://github.com/actix class=text-muted><i class="fa fa-github" aria-hidden=true></i></a></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js integrity=sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7 crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js integrity=sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8 crossorigin=anonymous></script><script src=https://actix.rs/js/bootstrap.min.js></script><script src=https://actix.rs/js/actix.js></script></body></html>