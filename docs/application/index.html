<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <link rel="stylesheet" href="https://actix.rs/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="https://actix.rs/css/bootstrap.css">
    <link rel="stylesheet" href="https://actix.rs/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://actix.rs/css/actix.css">
    <link rel="stylesheet" href="https://actix.rs/css/highlight.css">
    <link rel="icon" href="https://actix.rs/favicon.ico" title="actix">

    <title>Application</title>
  </head>
  <body>
    <header class="navbar navbar-light navbar-toggleable-md bd-navbar">
      <nav class="actix-main-nav">
        <div class="d-flex justify-content-between hidden-lg-up">
            <a href="https://actix.rs/" class="navbar-brand">
              <img src="https://actix.rs/img/logo-nav.png" class="align-middle" alt="">
            </a>
            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#actix-main-nav" aria-label="Toggle navigation" aria-controls="actix-main-nav" aria-expanded="false">
              <span class="navbar-toggler-icon"></span>
            </button>
        </div>
        <div class="navbar-collapse collapse" id="actix-main-nav">
          <ul class="nav navbar-nav">
            <li class="nav-item hd-lg-down">
              <a class="navbar-brand" href="https://actix.rs/"><img src="https://actix.rs/img/logo-nav.png" class="align-middle" alt=""></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://actix.rs/">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://actix.rs/docs/">Documentation</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://actix.rs/community/">Community</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://actix.rs/code/">Code</a>
            </li>
            <li class="nav-item language-selector">
              <i class="fa fa-fw fa-globe" aria-hidden="false"></i>
              <ul class="subitem">
              
                <li class="submenu-item"><a href="https://actix.rs/">English</a></li>
              
              <li ><a href="https://ruster-xyz.github.io/server/Actix-web/whatisactix.html">中文</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>



<div class="actix-pageheader">
  <div class="container">
    <h1 class="display-4">Application</h1>
    
  </div>
</div>

<div class="container actix-docs">
  <div class="row">
    <div class="col-md-3">

      <button class="btn doctoggle" type="button" data-toggle="collapse" data-target="#collapsing-docnav" aria-expanded="false" aria-controls="collapsing-docnav">
        Toggle navigation
      </button>

      <nav class="leftnav collapse show" id="collapsing-docnav">
        <div class="" id="">
          <h5>Introduction</h5>
          <div>
            <ul class="nav">
              
              <li>
                <a href="https://actix.rs/docs/">Welcome</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/whatis/">What is Actix</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/installation/">Installation</a>
              </li>
              
            </ul>
          </div>

          <h5>Basics</h5>
          <div>
            <ul class="nav">
              
              <li>
                <a href="https://actix.rs/docs/getting-started/">Getting Started</a>
              </li>
              
              <li class="active">
                <a href="https://actix.rs/docs/application/">Application</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/server/">Server</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/handlers/">Handlers</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/extractors/">Extractors</a>
              </li>
              
            </ul>
          </div>

          <h5>Advanced</h5>
          <div>
            <ul class="nav">
              
              <li>
                <a href="https://actix.rs/docs/errors/">Errors</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/url-dispatch/">URL Dispatch</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/request/">Requests</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/response/">Responses</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/testing/">Testing</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/middleware/">Middlewares</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/static-files/">Static Files</a>
              </li>
              
            </ul>
          </div>

          <h5>Protocols</h5>
          <div>
            <ul class="nav">
              
              <li>
                <a href="https://actix.rs/docs/websockets/">Websockets</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/http2/">HTTP/2.0</a>
              </li>
              
            </ul>
          </div>

          <h5>Patterns</h5>
          <div>
            <ul class="nav">
              
              <li>
                <a href="https://actix.rs/docs/autoreload/">Autoreloading</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/databases/">Databases</a>
              </li>
              
              <li>
                <a href="https://actix.rs/docs/sentry/">Sentry</a>
              </li>
              
            </ul>
          </div>

          <h5>API Documentation</h5>
          <div>
            <ul class="nav">
              <li><a href="https://docs.rs/actix" target="view_window">actix <span class="fa fa-external-link"></span></a></li>
              <li><a href="https://actix.rs/api/actix-web/stable/actix_web/" target="view_window">actix-web <span class="fa fa-external-link"></span></a></li>
            </ul>
          </div>
        </div>
      </nav>

    </div>
    <div class="col-md-9">
      <div class="actix-content">
        
  

<h1 id="writing-an-application">Writing an Application</h1>

<p><code>actix-web</code> provides various primitives to build web servers and applications with Rust.
It provides routing, middlewares, pre-processing of requests, post-processing of responses,
websocket protocol handling, multipart streams, etc.</p>

<p>All actix web servers are built around the <code>App</code> instance.  It is used for
registering routes for resources and middlewares.  It also stores application
state shared across all handlers within same application.</p>

<p>Applications act as a namespace for all routes, i.e. all routes for a specific application
have the same url path prefix. The application prefix always contains a leading &ldquo;/&rdquo; slash.
If a supplied prefix does not contain leading slash, it is automatically inserted.
The prefix should consist of value path segments.</p>

<blockquote>
<p>For an application with prefix <code>/app</code>,
any request with the paths <code>/app</code>, <code>/app/</code>, or <code>/app/test</code> would match;
however, the path <code>/application</code> would not match.</p>
</blockquote>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">index</span><span class="p">(</span><span class="n">req</span>: <span class="kp">&amp;</span><span class="nc">HttpRequest</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">impl</span><span class="w"> </span><span class="n">Responder</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="s">&#34;Hello world!&#34;</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="kd">let</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/app&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/index.html&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">method</span><span class="p">(</span><span class="n">Method</span>::<span class="n">GET</span><span class="p">).</span><span class="n">f</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">finish</span><span class="p">()</span></code></pre></div>

<p>In this example, an application with the <code>/app</code> prefix and a <code>index.html</code> resource
are created. This resource is available through the <code>/app/index.html</code> url.</p>

<blockquote>
<p>For more information, check the
<a href=".docs/url-dispatch/index.html#using-an-application-prefix-to-compose-applications">URL Dispatch</a> section.</p>
</blockquote>

<p>Multiple applications can be served with one server:</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="kd">let</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span>::<span class="n">new</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">vec</span><span class="o">!</span><span class="p">[</span><span class="w">
</span><span class="w">        </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">            </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/app1&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">            </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">        </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">            </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/app2&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">            </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">        </span><span class="n">App</span>::<span class="n">new</span><span class="p">().</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">    </span><span class="p">]</span><span class="w">
</span><span class="w"></span><span class="p">});</span></code></pre></div>

<p>All <code>/app1</code> requests route to the first application, <code>/app2</code> to the second, and all other to the third.
<strong>Applications get matched based on registration order</strong>. If an application with a more generic
prefix is registered before a less generic one, it would effectively block the less generic
application matching. For example, if an <code>App</code> with the prefix <code>&quot;/&quot;</code> was registered
as the first application, it would match all incoming requests.</p>

<h2 id="state">State</h2>

<p>Application state is shared with all routes and resources within the same application.
When using an http actor, state can be accessed with the <code>HttpRequest::state()</code> as read-only,
but interior mutability with <code>RefCell</code> can be used to achieve state mutability.
State is also available for route matching predicates and middlewares.</p>

<p>Let&rsquo;s write a simple application that uses shared state. We are going to store request count
in the state:</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">use</span><span class="w"> </span><span class="n">actix_web</span>::<span class="p">{</span><span class="n">http</span><span class="p">,</span><span class="w"> </span><span class="n">App</span><span class="p">,</span><span class="w"> </span><span class="n">HttpRequest</span><span class="p">};</span><span class="w">
</span><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">cell</span>::<span class="n">Cell</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">// This struct represents state
</span><span class="c1"></span><span class="k">struct</span> <span class="nc">AppState</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">counter</span>: <span class="nc">Cell</span><span class="o">&lt;</span><span class="kt">usize</span><span class="o">&gt;</span><span class="p">,</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">index</span><span class="p">(</span><span class="n">req</span>: <span class="kp">&amp;</span><span class="nc">HttpRequest</span><span class="o">&lt;</span><span class="n">AppState</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">req</span><span class="p">.</span><span class="n">state</span><span class="p">().</span><span class="n">counter</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// &lt;- get count
</span><span class="c1"></span><span class="w">    </span><span class="n">req</span><span class="p">.</span><span class="n">state</span><span class="p">().</span><span class="n">counter</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">count</span><span class="p">);</span><span class="w"> </span><span class="c1">// &lt;- store new count in state
</span><span class="c1"></span><span class="w">
</span><span class="w">    </span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&#34;Request number: {}&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> </span><span class="c1">// &lt;- response with count
</span><span class="c1"></span><span class="p">}</span></code></pre></div>

<p>When the app is initialized it needs to be passed the initial state:</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="n">App</span>::<span class="n">with_state</span><span class="p">(</span><span class="n">AppState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">counter</span>: <span class="nc">Cell</span>::<span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">method</span><span class="p">(</span><span class="n">http</span>::<span class="n">Method</span>::<span class="n">GET</span><span class="p">).</span><span class="n">f</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">finish</span><span class="p">()</span></code></pre></div>

<blockquote>
<p><strong>Note</strong>: http server accepts an application factory rather than an application
instance. Http server constructs an application instance for each thread, thus application state
must be constructed multiple times. If you want to share state between different threads, a
shared object should be used, e.g. <code>Arc</code>. Application state does not need to be <code>Send</code> and <code>Sync</code>,
but the application factory must be <code>Send</code> + <code>Sync</code>.</p>

<p>To start the previous app, create it into a closure:</p>
</blockquote>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="n">server</span>::<span class="n">new</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">App</span>::<span class="n">with_state</span><span class="p">(</span><span class="n">AppState</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">counter</span>: <span class="nc">Cell</span>::<span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">})</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">method</span><span class="p">(</span><span class="n">http</span>::<span class="n">Method</span>::<span class="n">GET</span><span class="p">).</span><span class="n">f</span><span class="p">(</span><span class="n">index</span><span class="p">))</span><span class="w">
</span><span class="w"></span><span class="p">}).</span><span class="n">bind</span><span class="p">(</span><span class="s">&#34;127.0.0.1:8080&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span><span class="w">
</span><span class="w">    </span><span class="p">.</span><span class="n">run</span><span class="p">()</span></code></pre></div>

<h2 id="combining-applications-with-different-state">Combining applications with different state</h2>

<p>Combining multiple applications with different state is possible as well.</p>

<p><a href="https://docs.rs/actix-web/*/actix_web/server/fn.new.html">server::new</a> requires the handler to have a single type.</p>

<p>This limitation can easily be overcome with the <a href="https://docs.rs/actix-web/*/actix_web/struct.App.html#method.boxed">App::boxed</a> method, which converts an App into a boxed trait object.</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">struct</span> <span class="nc">State1</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">struct</span> <span class="nc">State2</span><span class="p">;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">server</span>::<span class="n">new</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">vec</span><span class="o">!</span><span class="p">[</span><span class="w">
</span><span class="w">            </span><span class="n">App</span>::<span class="n">with_state</span><span class="p">(</span><span class="n">State1</span><span class="p">)</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/app1&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">()))</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">boxed</span><span class="p">(),</span><span class="w">
</span><span class="w">            </span><span class="n">App</span>::<span class="n">with_state</span><span class="p">(</span><span class="n">State2</span><span class="p">)</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/app2&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">()))</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">boxed</span><span class="p">(),</span><span class="w">
</span><span class="w">                </span><span class="p">]</span><span class="w">
</span><span class="w">    </span><span class="p">}).</span><span class="n">bind</span><span class="p">(</span><span class="s">&#34;127.0.0.1:8080&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">unwrap</span><span class="p">()</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">run</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="p">}</span></code></pre></div>

<h2 id="using-an-application-prefix-to-compose-applications">Using an Application Prefix to Compose Applications</h2>

<p>The <code>App::prefix()</code> method allows to set a specific application prefix.
This prefix represents a resource prefix that will be prepended to all resource patterns added
by the resource configuration. This can be used to help mount a set of routes at a different
location than the included callable&rsquo;s author intended while still maintaining the same
resource names.</p>

<p>For example:</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">show_users</span><span class="p">(</span><span class="n">req</span>: <span class="kp">&amp;</span><span class="nc">HttpRequest</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nc">HttpResponse</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">unimplemented</span><span class="o">!</span><span class="p">()</span><span class="w">
</span><span class="w"></span><span class="p">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">prefix</span><span class="p">(</span><span class="s">&#34;/users&#34;</span><span class="p">)</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/show&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="n">show_users</span><span class="p">))</span><span class="w">
</span><span class="w">        </span><span class="p">.</span><span class="n">finish</span><span class="p">();</span><span class="w">
</span><span class="w"></span><span class="p">}</span></code></pre></div>

<p>In the above example, the <em>show_users</em> route will have an effective route pattern of
<em>/users/show</em> instead of <em>/show</em> because the application&rsquo;s prefix argument will be prepended
to the pattern. The route will then only match if the URL path is <em>/users/show</em>,
and when the <code>HttpRequest.url_for()</code> function is called with the route name show_users,
it will generate a URL with that same path.</p>

<h2 id="application-predicates-and-virtual-hosting">Application predicates and virtual hosting</h2>

<p>You can think of a predicate as a simple function that accepts a <em>request</em> object reference
and returns <em>true</em> or <em>false</em>. Formally, a predicate is any object that implements the
<a href="../actix_web/pred/trait.Predicate.html"><code>Predicate</code></a> trait. Actix provides
several predicates, you can check
<a href="../../actix-web/actix_web/pred/index.html#functions">functions section</a> of api docs.</p>

<p>Any of this predicates could be used
with <a href="../actix_web/struct.App.html#method.filter"><code>App::filter()</code></a> method. One of the
provided predicates is <a href="../actix_web/pred/fn.Host.html"><code>Host</code></a>, it can be used
as application&rsquo;s filter based on request&rsquo;s host information.</p>






<div class="highlight"><pre class="chroma"><code class="language-rust" data-lang="rust"><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">server</span>::<span class="n">new</span><span class="p">(</span><span class="o">||</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="w">        </span><span class="n">vec</span><span class="o">!</span><span class="p">[</span><span class="w">
</span><span class="w">            </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pred</span>::<span class="n">Host</span><span class="p">(</span><span class="s">&#34;www.rust-lang.org&#34;</span><span class="p">))</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">            </span><span class="n">App</span>::<span class="n">new</span><span class="p">()</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pred</span>::<span class="n">Host</span><span class="p">(</span><span class="s">&#34;users.rust-lang.org&#34;</span><span class="p">))</span><span class="w">
</span><span class="w">                </span><span class="p">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">            </span><span class="n">App</span>::<span class="n">new</span><span class="p">().</span><span class="n">resource</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="w"> </span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">f</span><span class="p">(</span><span class="o">|</span><span class="n">r</span><span class="o">|</span><span class="w"> </span><span class="n">HttpResponse</span>::<span class="nb">Ok</span><span class="p">())),</span><span class="w">
</span><span class="w">        </span><span class="p">]</span><span class="w">
</span><span class="w">    </span><span class="p">});</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="n">server</span><span class="p">.</span><span class="n">run</span><span class="p">();</span><span class="w">
</span><span class="w"></span><span class="p">}</span></code></pre></div>


        <div class="github-edit">
            <a class="fa fa-github" href="https://github.com/actix/actix-website/tree/master/content/docs/application.md"> Edit on GitHub</a>
        </div>
        
        <div class="actix-next"><b>Next up</b>: <a href = /docs/server/>
         Server</a></div>
      </div>
    </div>
  </div>
</div>

    <footer class="actix-footer">
      <div class="text-muted actix-footer-gray d-flex justify-content-between">
        <div class="actix-footer-info">
          Copyright © 2018 The Actix Team
        </div>
        <div class="actix-footer-social">
          <a href="https://github.com/actix" class="text-muted"><i class="fa fa-github" aria-hidden="true"></i></a>
        </div>
      </div>
    </footer>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8" crossorigin="anonymous"></script>
    <script src="https://actix.rs/js/bootstrap.min.js"></script>
    <script src="https://actix.rs/js/actix.js"></script>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-110322332-1', 'auto');
ga('send', 'pageview');
</script>

  </body>
</html>
